#!/usr/bin/make -f

# Override binary target to not use makefile buildsystem
binary:
	dh binary --buildsystem=none

override_dh_auto_install:
	# Install the main binary
	install -D -m 755 target/release/hardn debian/hardn/usr/bin/hardn
	# Install modules
	install -d debian/hardn/usr/share/hardn/modules
	install -m 755 usr/share/hardn/modules/*.sh debian/hardn/usr/share/hardn/modules/ 2>/dev/null || true
	# Install tools
	install -d debian/hardn/usr/share/hardn/tools
	install -m 755 usr/share/hardn/tools/*.sh debian/hardn/usr/share/hardn/tools/ 2>/dev/null || true
	# Install API
	install -d debian/hardn/usr/share/hardn/src
	install -m 644 src/hardn-api.py debian/hardn/usr/share/hardn/src/
	# Install service manager
	install -m 755 usr/share/hardn/scripts/hardn-service-manager.sh debian/hardn/usr/bin/hardn-service-manager
	# Install config
	install -d debian/hardn/etc/aide
	install -m 644 etc/aide/aide.conf debian/hardn/etc/aide/ 2>/dev/null || true
	# Install systemd services
	install -d debian/hardn/lib/systemd/system
	install -m 644 systemd/*.service debian/hardn/lib/systemd/system/ 2>/dev/null || true

%:
	dh $@ --buildsystem=makefile