# LEGION Advanced Security Monitoring Configuration
# Comprehensive threat detection and automated response system

[general]
# Baseline storage directory
baseline_dir = "/var/lib/hardn/legion"

# Enable verbose logging for detailed monitoring
verbose = true

# Output format (text/json/xml)
output_format = "json"

# Log file location
log_file = "/var/log/hardn/legion.log"

# Maximum log file size (MB)
max_log_size = 100

# Log rotation count
log_rotate_count = 5

# Enable debug mode for troubleshooting
debug_mode = false

# Monitoring interval in seconds
monitoring_interval = 30

# Enable machine learning analysis
enable_ml_analysis = true

# Threat intelligence update interval (hours)
threat_intel_update_interval = 6

[monitoring]
# Core monitoring modules
enable_inventory = true
enable_auth = true
enable_packages = true
enable_filesystem = true
enable_processes = true
enable_network = true
enable_kernel = true
enable_containers = true
enable_logs = true
enable_memory = true
enable_usb = true
enable_crypto = true
enable_permissions = true
enable_services = true
enable_vulnerabilities = true

# Advanced monitoring features
enable_anomaly_detection = true
enable_behavioral_analysis = true
enable_predictive_threats = true
enable_zero_day_detection = true
enable_lateral_movement_detection = true
enable_data_exfiltration_detection = true
enable_ransomware_detection = true
enable_rootkit_detection = true
enable_malware_signatures = true
enable_phishing_detection = true
enable_ddos_detection = true
enable_brute_force_detection = true
enable_privilege_escalation_detection = true
enable_webshell_detection = true
enable_command_injection_detection = true
enable_sql_injection_detection = true

# Performance monitoring
enable_cpu_monitoring = true
enable_memory_monitoring = true
enable_disk_monitoring = true
enable_network_monitoring = true
enable_system_load_monitoring = true
enable_io_monitoring = true

# Cloud and virtualization monitoring
enable_cloud_security = true
enable_virtualization_security = true
enable_container_security = true
enable_orchestration_security = true

[hardware_monitoring]
# Hardware component monitoring
enable_hardware_inventory = true
enable_cpu_monitoring = true
enable_memory_hardware = true
enable_disk_hardware = true
enable_network_hardware = true
enable_usb_hardware = true
enable_pci_devices = true
enable_motherboard_monitoring = true
enable_bios_monitoring = true
enable_firmware_monitoring = true
enable_sensor_monitoring = true
enable_power_monitoring = true
enable_temperature_monitoring = true
enable_fan_monitoring = true
enable_voltage_monitoring = true

# Hardware anomaly detection
enable_hardware_anomalies = true
enable_device_changes = true
enable_hardware_tampering = true
enable_dma_attacks = true
enable_hardware_backdoors = true

# Hardware performance monitoring
hardware_performance_baseline = true
hardware_degradation_detection = true
hardware_failure_prediction = true

[kernel_monitoring]
# Kernel-level monitoring
enable_kernel_modules = true
enable_system_calls = true
enable_kernel_threads = true
enable_interrupt_monitoring = true
enable_sysctl_monitoring = true
enable_proc_monitoring = true
enable_kmsg_monitoring = true
enable_dmesg_monitoring = true
enable_kernel_logs = true

# Kernel security monitoring
enable_selinux_monitoring = true
enable_apparmor_monitoring = true
enable_seccomp_monitoring = true
enable_capability_monitoring = true
enable_namespace_monitoring = true
enable_cgroups_monitoring = true

# Kernel heuristics and anomaly detection
enable_kernel_anomalies = true
enable_rootkit_detection = true
enable_kernel_module_hijacking = true
enable_system_call_hijacking = true
enable_interrupt_hijacking = true
enable_idt_hijacking = true
enable_syscall_table_hijacking = true
enable_vfs_hijacking = true
enable_netfilter_hijacking = true

# Kernel performance monitoring
kernel_performance_monitoring = true
kernel_memory_monitoring = true
kernel_cpu_monitoring = true
kernel_io_monitoring = true
context_switch_monitoring = true
page_fault_monitoring = true

[kernel_heuristics]
# Advanced kernel heuristics
enable_kernel_entropy_analysis = true
enable_timing_anomalies = true
enable_cache_anomalies = true
enable_branch_prediction_anomalies = true
enable_speculative_execution_monitoring = true
enable_side_channel_detection = true
enable_meltdown_detection = true
enable_spectre_detection = true
enable_rowhammer_detection = true

# Kernel behavioral analysis
kernel_behavioral_baseline = true
syscall_pattern_analysis = true
interrupt_pattern_analysis = true
memory_access_pattern_analysis = true
network_stack_behavior = true

# Kernel integrity monitoring
kernel_integrity_checking = true
kernel_module_signing_check = true
kernel_lockdown_mode = true
secure_boot_monitoring = true
tpm_monitoring = true
measured_boot_verification = true

[hardware_heuristics]
# Hardware-level heuristics
enable_hardware_timing_analysis = true
enable_power_consumption_analysis = true
enable_electromagnetic_analysis = false
enable_acoustic_analysis = false
enable_hardware_fingerprinting = true
enable_device_fingerprinting = true
enable_bus_traffic_analysis = true
enable_memory_bus_monitoring = true
enable_pci_bus_monitoring = true
enable_usb_bus_monitoring = true

# Hardware behavioral analysis
hardware_behavioral_baseline = true
device_usage_pattern_analysis = true
power_pattern_analysis = true
thermal_pattern_analysis = true
vibration_pattern_analysis = false

# Hardware integrity and security
hardware_integrity_checking = true
trusted_platform_module = true
hardware_security_modules = true
secure_element_monitoring = true
hardware_root_of_trust = true
platform_configuration_registers = true

[low_level_monitoring]
# Low-level system monitoring
enable_bios_monitoring = true
enable_uefi_monitoring = true
enable_acpi_monitoring = true
enable_smbios_monitoring = true
enable_efi_variables = true
enable_bootloader_monitoring = true
enable_initrd_monitoring = true

# Firmware and microcode monitoring
firmware_update_monitoring = true
microcode_update_monitoring = true
firmware_integrity_checking = true
firmware_rootkit_detection = true

# Hypervisor and virtualization monitoring
hypervisor_detection = true
virtualization_escaping_detection = true
nested_virtualization_monitoring = true
container_escape_detection = true

# Ring-level monitoring
ring0_monitoring = true
ring3_monitoring = true
privilege_level_transitions = true
syscall_auditing = true
interrupt_auditing = true

[response]
# Automated response actions
enable_automated_response = true
enable_quarantine_mode = true
enable_isolation_mode = false
enable_kill_suspicious_processes = true
enable_block_suspicious_ips = true
enable_disable_compromised_accounts = true
enable_alert_administrators = true
enable_log_forensic_data = true

# Response thresholds
response_severity_threshold = "medium"
auto_response_delay_seconds = 10
max_concurrent_responses = 5

# Quarantine settings
quarantine_directory = "/var/lib/hardn/quarantine"
max_quarantine_size_gb = 10
quarantine_retention_days = 30

# Alert settings
alert_email_enabled = true
alert_email_recipients = ["admin@yourdomain.com", "security@yourdomain.com"]
alert_sms_enabled = false
alert_sms_numbers = []
alert_webhook_enabled = true
alert_webhook_urls = ["https://your-monitoring-system.com/webhook"]

# Escalation settings
escalation_enabled = true
escalation_levels = ["low", "medium", "high", "critical"]
escalation_commands = {
    "low": "logger 'LEGION: Low severity alert detected'",
    "medium": "wall 'LEGION: Medium severity security alert'",
    "high": "systemctl start emergency-alert.service",
    "critical": "systemctl isolate emergency.target"
}

[threat_intelligence]
# Threat intelligence sources
enable_virus_total = true
enable_abuse_ipdb = true
enable_malware_bazaar = true
enable_openphish = true
enable_phishtank = true
enable_urlhaus = true
enable_hybrid_analysis = true

# IOC (Indicators of Compromise) settings
ioc_update_interval_hours = 4
ioc_cache_size_mb = 50
ioc_retention_days = 90

# Custom threat feeds
custom_threat_feeds = [
    "https://your-threat-feed.com/api/v1/indicators",
    "https://internal-threat-intel.company.com/feed"
]

# Threat scoring
threat_score_threshold = 0.7
false_positive_filtering = true
adaptive_scoring = true

[detection]
# Detection sensitivity levels
file_system_sensitivity = "high"
process_sensitivity = "high"
network_sensitivity = "medium"
memory_sensitivity = "high"
behavior_sensitivity = "high"

# Advanced detection algorithms
enable_signature_based_detection = true
enable_heuristic_detection = true
enable_behavior_based_detection = true
enable_machine_learning_detection = true
enable_sandbox_analysis = false

# Anomaly detection settings
anomaly_detection_window_minutes = 60
anomaly_threshold_standard_deviations = 3.0
baseline_learning_period_days = 7

# Memory forensics
enable_memory_forensics = true
memory_dump_on_suspicion = false
memory_analysis_depth = "full"

# Network analysis
enable_deep_packet_inspection = true
enable_ssl_inspection = false
network_traffic_capture = true
traffic_capture_size_mb = 100

[performance]
# Performance tuning
max_concurrent_scans = 4
scan_timeout_seconds = 300
memory_limit_mb = 512
cpu_limit_percent = 30

# Resource monitoring
resource_monitoring_enabled = true
resource_alert_threshold_percent = 80
auto_throttle_on_high_load = true

# Caching settings
cache_enabled = true
cache_size_mb = 100
cache_ttl_hours = 24

[integration]
# External system integrations
enable_splunk_integration = false
splunk_host = "splunk.yourdomain.com"
splunk_port = 8088
splunk_token = "your-splunk-token"

enable_elasticsearch_integration = false
elasticsearch_hosts = ["http://localhost:9200"]
elasticsearch_index = "hardn-legion"

enable_syslog_integration = true
syslog_server = "localhost"
syslog_port = 514
syslog_facility = "security"

# SIEM integration
siem_integration_enabled = false
siem_endpoint = "https://your-siem.com/api/events"
siem_api_key = "your-siem-api-key"

[thresholds]
# Alert thresholds
max_auth_failures = 3
max_orphan_processes = 5
max_suspicious_executables = 3
max_suspicious_connections = 10
max_memory_anomalies = 5
max_disk_anomalies = 3
max_network_anomalies = 8

# Performance thresholds
cpu_usage_alert_percent = 90
memory_usage_alert_percent = 85
disk_usage_alert_percent = 95
network_traffic_alert_mbps = 100

# Security thresholds
max_failed_logins_per_minute = 5
max_suspicious_files_per_hour = 10
max_blocked_ips_per_hour = 20

[exclusions]
# Files/directories to exclude from filesystem checks
exclude_paths = [
    "/proc",
    "/sys",
    "/dev",
    "/tmp",
    "/var/tmp",
    "/var/cache",
    "/var/log",
    "/run",
    "/snap",
    "/var/lib/docker",
    "/var/lib/lxc"
]

# Processes to exclude from monitoring
exclude_processes = [
    "systemd",
    "init",
    "bash",
    "zsh",
    "fish",
    "sshd",
    "cron",
    "rsyslogd",
    "systemd-journald",
    "systemd-logind",
    "dbus-daemon",
    "polkitd",
    "NetworkManager",
    "wpa_supplicant",
    "dhcpcd",
    "systemd-resolved"
]

# Network ports to exclude from monitoring
exclude_ports = [22, 80, 443, 53, 67, 68, 123, 514]

# IP addresses to exclude
exclude_ips = [
    "127.0.0.1",
    "localhost",
    "::1",
    "10.0.0.0/8",
    "172.16.0.0/12",
    "192.168.0.0/16"
]

# File extensions to exclude from scanning
exclude_extensions = [
    ".log",
    ".tmp",
    ".cache",
    ".pid",
    ".lock",
    ".swp",
    ".bak"
]

[logging]
# Detailed logging configuration
log_level = "info"
log_format = "json"
log_compression = true
log_encryption = false

# Remote logging
remote_logging_enabled = false
remote_log_server = "log.yourdomain.com"
remote_log_port = 514

# Audit logging
audit_logging_enabled = true
audit_log_file = "/var/log/hardn/legion-audit.log"
audit_retention_days = 365

[maintenance]
# Maintenance settings
auto_update_enabled = true
update_check_interval_hours = 24
backup_before_update = true
rollback_on_failure = true

# Cleanup settings
log_cleanup_enabled = true
cleanup_interval_hours = 24
max_log_age_days = 30

# Health checks
health_check_enabled = true
health_check_interval_minutes = 15
health_alert_threshold = 3