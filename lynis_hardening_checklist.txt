HARDN Lynis Hardening Checklist
================================
!!!! LOG YOUR MAHCINE DATA HERE !!!!
- Ubuntu 24.04 (bare metal) = 79 with some issues on debsums, fail2ban and aide. 
---------------------------------------------------------------------------------------------------
- Lets audit this one by one to ensure we have thee in place, and if not, document why and move on. 

Authentication & Accounts
- [x] Require password history (pam_unix.so remember=5) in /etc/pam.d/common-password
- [x] Set account inactivity defaults (chage --inactive 30 and INACTIVE=30 in /etc/default/useradd)
- [x] Ensure service accounts use /usr/sbin/nologin or equivalent restricted shells

File Integrity & Auditing
- [x] Install AIDE package
- [x] Initialize AIDE database (aideinit) and store baseline
- [x] Install and enable acct process accounting service
- [x] Verify auditd space_left_action and related thresholds are configured

Kernel & Entropy
- [x] Decide and document IPv6 stance (disable via sysctl/blacklist or secure defaults)
- [x] Install entropy daemon (haveged or rng-tools) and ensure it is enabled
- [ ] Needed improvement on entropy daemon service

Services & Logging
- [x] Configure chrony or systemd-timesyncd with hardened settings
- [x] Configure remote syslog/rsyslog forwarding for critical logs
- [x] Ensure /var/log/journal exists with persistent storage and size limits in journald.conf

Software Updates & Packages
- [x] Install debsums and generate checksums (debsums --generate=all)
- [x] Add APT hardening options in /etc/apt/apt.conf.d/99hardn
- [x] Verify unattended-upgrades periodic settings cover security updates
- [x] Remove duplicate ClamAV installation steps in hardening module

Filesystem & Storage
- [x] Audit world-writable directories (find / -xdev -type d -perm -0002) and remediate

Banners & Access Controls
- [x] Populate /etc/issue and /etc/issue.net with security banner
- [x] Configure sudo logging (Defaults logfile="/var/log/sudo.log")
- [x] Run update-initramfs -u after module blacklist changes (e.g., firewire)
- [x] Capture aa-status output post-hardening and archive summary

Validation
- [x] Run Lynis baseline scan and record report location
- [ ] Re-run Lynis after each major change and update checklist status
